"use strict";(self.webpackChunkcore=self.webpackChunkcore||[]).push([[2323],{5680:(e,t,o)=>{o.d(t,{xA:()=>l,yg:()=>h});var n=o(6540);function r(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function a(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function i(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?a(Object(o),!0).forEach((function(t){r(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function s(e,t){if(null==e)return{};var o,n,r=function(e,t){if(null==e)return{};var o,n,r={},a=Object.keys(e);for(n=0;n<a.length;n++)o=a[n],t.indexOf(o)>=0||(r[o]=e[o]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)o=a[n],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(r[o]=e[o])}return r}var c=n.createContext({}),u=function(e){var t=n.useContext(c),o=t;return e&&(o="function"==typeof e?e(t):i(i({},t),e)),o},l=function(e){var t=u(e.components);return n.createElement(c.Provider,{value:t},e.children)},d="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var o=e.components,r=e.mdxType,a=e.originalType,c=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),d=u(o),m=r,h=d["".concat(c,".").concat(m)]||d[m]||p[m]||a;return o?n.createElement(h,i(i({ref:t},l),{},{components:o})):n.createElement(h,i({ref:t},l))}));function h(e,t){var o=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=o.length,i=new Array(a);i[0]=m;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s[d]="string"==typeof e?e:r,i[1]=s;for(var u=2;u<a;u++)i[u]=o[u];return n.createElement.apply(null,i)}return n.createElement.apply(null,o)}m.displayName="MDXCreateElement"},9788:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>p,frontMatter:()=>a,metadata:()=>s,toc:()=>u});var n=o(8168),r=(o(6540),o(5680));const a={id:"Quality_of_Service_and_Job_Limits.md",toplevel:!0,title:"Quality of Service and Job Limits"},i=void 0,s={unversionedId:"CHPC_Guide/Quality_of_Service_and_Job_Limits.md",id:"CHPC_Guide/Quality_of_Service_and_Job_Limits.md",title:"Quality of Service and Job Limits",description:"In SLURM you can set up Quality of Service (QOS) rules to enforce",source:"@site/docs/CHPC_Guide/Quality_of_Service_and_Job_Limits.md",sourceDirName:"CHPC_Guide",slug:"/CHPC_Guide/Quality_of_Service_and_Job_Limits.md",permalink:"/Core-Docs/docs/CHPC_Guide/Quality_of_Service_and_Job_Limits.md",draft:!1,editUrl:"https://github.com/UCGD/Core-Docs/docs/docs/CHPC_Guide/Quality_of_Service_and_Job_Limits.md",tags:[],version:"current",frontMatter:{id:"Quality_of_Service_and_Job_Limits.md",toplevel:!0,title:"Quality of Service and Job Limits"},sidebar:"tutorialSidebar",previous:{title:"Locally Mount PE Directories",permalink:"/Core-Docs/docs/CHPC_Guide/Locally_Mount_PE_Directories"},next:{title:"Rclone and Ceph",permalink:"/Core-Docs/docs/CHPC_Guide/Rclone_and_Ceph"}},c={},u=[],l={toc:u},d="wrapper";function p(e){let{components:t,...o}=e;return(0,r.yg)(d,(0,n.A)({},l,o,{components:t,mdxType:"MDXLayout"}),(0,r.yg)("p",null,"In SLURM you can set up Quality of Service (QOS) rules to enforce\nresource limits (maximum jobs per user, CPUs, runtime, etc.) as well as\nscheduling priorities. We use QOS rules to ensure equitable access to\nresources among UCGD users. The QOS you wish to use is specified using\nthe '","-","-qos' option in your batch submission. In the absence of a\nspecific '","-","-qos' option in the batch script, a default is applied."),(0,r.yg)("h1",{id:"default"},"Default"),(0,r.yg)("p",null,"Access to UCGD resources (i.e ucgd-rw account/partition) are limited to\nUCGD members, and jobs submitted on those resources are limited to a\nmaximum wall clock of 24 hours. Also users are limited to 28 active jobs\nwith a total group limit of 42 active jobs (half the nodes). For longer\nrunning jobs, collaborator access to UCGD resources, or access to more\nidle resources there are additional QOS's outlined below that can lift\nsome restriction."),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"Example")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"#!/bin/bash\n#SBATCH -t 24:00:00   #time\n#SBATCH -N 1          #number of nodes\n#SBATCH -A ucgd-rw    #account\n#SBATCH -p ucgd-rw    #partition\n#SBATCH --qos ucgd-rw #QOS\n#SBATCH -J test_job   #job name\n")),(0,r.yg)("h1",{id:"long-running-jobs"},"Long Running Jobs"),(0,r.yg)("p",null,'Jobs of up to 96 hours (4 days) are allowed on UCGD resources by adding\nthe \\"#SBATCH ',"-",'-qos ucgd-long-kp\\" parameter at the top of your job. A\nmaximum of 21 jobs can run in this QOS per user and 28 per group (i.e.\none-third of the UCGD nodes). This limitation ensures that long running\njobs do not completely tie up all nodes on the cluster for several days.'),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"Example")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"#!/bin/bash\n#SBATCH -t 96:00:00        #time\n#SBATCH -N 1               #number of nodes\n#SBATCH -A ucgd-rw         #account\n#SBATCH -p ucgd-rw         #partition\n#SBATCH --qos ucgd-long-rw #QOS\n#SBATCH -J test_job        #job name\n")),(0,r.yg)("h1",{id:"low-priority-jobs"},"Low Priority Jobs"),(0,r.yg)("p",null,"If a user wishes to submit jobs to all idle UCGD nodes without a cap on\nthe number of active jobs (either user or group limits), ",'[they can\nsubmit jobs to a low priority QOS (\\"#SBATCH ',"-",'-qos\nucgd-low-rw\\")]',". With this QOS, your jobs\nwill always be at the back of the queue compared to other users, and\nyour job is preemptable to high priority clinical jobs, but the trade\noff is you can use all idle resources. Time limit maximum is also lower\nthan the default QOS (8 hours)."),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"Example")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"#!/bin/bash\n#SBATCH -t 8:00:00       #time\n#SBATCH -N 1              #number of nodes\n#SBATCH -A ucgd-rw        #account\n#SBATCH -p ucgd-rw        #partition\n#SBATCH --qos ucgd-low-rw #QOS\n#SBATCH -J test_job       #job name\n")),(0,r.yg)("h1",{id:"collaborator-access"},"Collaborator Access"),(0,r.yg)("p",null,"Collaborators can access UCGD resources in a limited fashion, but to do\nso they must first be added to the ucgdcollaborator group. Lab managers\ncan request that individuals be added to the ucgdcollaborator group with\nucgd-guest-rw QOS access by submitting a ticket including the\ncollaborator's name and UID to the ",(0,r.yg)("a",{parentName:"p",href:"https://jira.chpc.utah.edu%20CHPC%20Service%20Desk"},"https://jira.chpc.utah.edu CHPC\nService\nDesk"),'.\nBy adding \\" #SBATCH ',"-",'-qos ucd-guest-kp\\" to the top of their batch\nscripts, members of the group ucgdcollaborator can submit jobs on up to\n7 nodes per user (group limit is 14) with a 24 hour wall clock maximum.\nCollaborators may also be given limited (usually Read-Only) access to\nfiles and projects (contact Shawn, Barry, or Carson to modify the access\ncontrol lists). As a CHPC user they will have write access to the\ngeneral Lustre space at /scratch/mamoth/serial and should do analyses\nthere rather than on /scratch/ucgd/lustre.'),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"Example")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"#!/bin/bash\n#SBATCH -t 24:00:00         #time\n#SBATCH -N 1                #number of nodes\n#SBATCH -A ucgd-rw          #account\n#SBATCH -p ucgd-rw          #partition\n#SBATCH --qos ucgd-guest-rw #QOS\n#SBATCH -J test_job         #job name\n")),(0,r.yg)("h1",{id:"production-access"},"[Production Access]"),(0,r.yg)("p",null,"[There are two QOS options that are specifically available to the data\nproduction team: ucgd-prod-rw and ucgd-nicu-rw. An explanation of the\nproduction QOS's is available here for reference purposes only. The\ndata production pipeline consists of the initial analysis steps that\nproduce the BAM and VCF files consumed by almost all downstream research\nwithin UCGD. Because this data is the basis of most UCGD research, funds\ncluster hardware purchases, and may be urgently needed for clinical\ncare, jobs in ]","these","[ QOS's are given a\npriority bonus. This higher priority means that production jobs can\nadvance through the queue faster than default jobs will. However, no\nmore than 56 nodes (two-thirds of the UCGD nodes) can be active in the\nmain production QOS (ucgd-prod-rw) at any one time. There is no limit\nfor the clinical care QOS (ucgd-nicu-rw). The clinical care QOS has the\nfurther ability to ]","preempt","[ active jobs\nin the ucgd-low-rw QOS. This is necessary for critical patient care. The\noverall effect of these QOS's is that production jobs will not be\nbacklogged. Instead, they will jump to the front of the line. The\nproduction QOS is specified by adding \\\"#SBATCH ","-",'-qos ucgd-prod-rw\\" or\n\\"#SBATCH ',"-",'-qos ucgd-nicu-rw\\" to the top of a batch\nsubmission.]'),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"Example")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"#!/bin/bash\n#SBATCH -t 24:00:00        #time\n#SBATCH -N 7               #number of nodes\n#SBATCH -A ucgd-rw         #account\n#SBATCH -p ucgd-rw         #partition\n#SBATCH --qos ucgd-prod-rw #QOS\n#SBATCH -J test_job        #job name\n")))}p.isMDXComponent=!0}}]);